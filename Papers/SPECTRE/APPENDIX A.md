# APPENDIX A

# INTUITION AND EXAMPLES

In this section we provide some basic explanations and intuitions regarding the operation of SPECTRE. 
We focus primarily on explaining the ideas underlying Alg. 1 that is at the core of the protocol. 
We later go on to present examples for simple attacks that shed some light on how resilience is achieved.

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æä¾›å…³äºSPECTREæ“ä½œçš„ä¸€äº›åŸºæœ¬è§£é‡Šå’Œæ€è·¯ã€‚ 
æˆ‘ä»¬ä¸»è¦å…³æ³¨è§£é‡Šä½œä¸ºåè®®æ ¸å¿ƒçš„ç®—æ³•1çš„åŸºæœ¬æ€æƒ³ã€‚ 
æˆ‘ä»¬ç¨åç»§ç»­ä»‹ç»ç®€å•æ”»å‡»çš„ä¾‹å­ï¼Œä»¥é˜æ˜å¦‚ä½•å®ç°éŸ§æ€§ã€‚

**Intuition 1 (Vote in favour of visible blocks).** 
If a block x is known by honest participants, their blocks will include it in their past. 
Given that blocks vote in favour of blocks in their past (over other unknown blocks), and given that honest nodes publish their blocks quickly, hidden attacker blocks lose votes.

**æ€è·¯1ï¼ˆæŠ•ç¥¨èµæˆå¯è§å—ï¼‰ã€‚** 
å¦‚æœè¯šå®çš„å‚ä¸è€…çŸ¥é“åŒºå—xï¼Œä»–ä»¬çš„åŒºå—å°†åŒ…æ‹¬åœ¨ä»–ä»¬çš„è¿‡å»ã€‚ 
é‰´äºåŒºå—æŠ•ç¥¨èµæˆè¿‡å»çš„åŒºå—ï¼ˆè¶…è¿‡å…¶ä»–æœªçŸ¥åŒºå—ï¼‰ï¼Œå¹¶ä¸”é‰´äºè¯šå®çš„èŠ‚ç‚¹å¿«é€Ÿå‘å¸ƒåŒºå—ï¼Œéšè—çš„æ”»å‡»è€…åŒºå—ä¼šå¤±å»æŠ•ç¥¨ã€‚



**Intuition 2 (Majority ampliï¬cation).** 
Given blocks x, y that contain potential conï¬‚icts, blocks that are generated by honest participants after their publication reference both of them in the DAG. 
According to Alg. 1, these new blocks adopt the vote of the sub-DAG in their past with regards to x and y . 
Thus, if block x precedes block y , additional votes that support this decision are added, and the attacker will ï¬nd it more difï¬cult to reverse the vote.

**æ€è·¯2ï¼ˆå¤šæ•°æ”¾å¤§ï¼‰ã€‚** 
å‡å®šåŒºå—xï¼ŒyåŒ…å«æ½œåœ¨å†²çªçš„äº¤æ˜“ï¼Œåœ¨å®ƒä»¬å‘å¸ƒåç”±è¯šå®çš„å‚ä¸è€…åœ¨DAGä¸­å¼•ç”¨å®ƒä»¬ã€‚ 
æ ¹æ®ç®—æ³•1ï¼Œè¿™äº›æ–°å—é‡‡çº³äº†å®ƒä»¬è¿‡å»é›†çš„å­DAGä¸­å…³äºxå’Œyçš„æŠ•ç¥¨ã€‚ 
å› æ­¤ï¼Œå¦‚æœåŒºå—xä½äºåŒºå—yä¹‹å‰ï¼Œåˆ™ä¼šå¢åŠ æ”¯æŒè¯¥å†³ç­–çš„é™„åŠ æŠ•ç¥¨ï¼Œæ”»å‡»è€…å°†å‘ç°æ›´éš¾ä»¥æ‰­è½¬æŠ•ç¥¨ç»“æœã€‚

**Intuition 3 (Referencing recent blocks is beneï¬cial).** 
Blocks from the past vote according to their future. 
Thus if an attacker creates a block that does not reference recent blocks, it is at a disadvantage compared to other blocks that do (it loses votes from recent blocks it did not reference and did not â€œconvinceâ€).

**æ€è·¯3ï¼ˆå¼•ç”¨æœ€è¿‘çš„å—æ˜¯æœ‰ç›Šçš„ï¼‰ã€‚** 
è¿‡å»é›†çš„åŒºå—æ ¹æ®å®ƒä»¬çš„æœªæ¥é›†æŠ•ç¥¨ã€‚ 
å› æ­¤ï¼Œå¦‚æœæ”»å‡»è€…åˆ›å»ºäº†ä¸€ä¸ªæ²¡æœ‰å¼•ç”¨æœ€è¿‘å—çš„å—ï¼Œä¸å…¶ä»–å—ç›¸æ¯”ï¼Œå®ƒå°±å¤„äºåŠ£åŠ¿ï¼ˆå®ƒå¤±å»äº†å®ƒæ²¡æœ‰å¼•ç”¨å¹¶ä¸”æ²¡æœ‰â€œè¯´æœâ€çš„æœ€è¿‘å—çš„æŠ•ç¥¨ï¼‰ã€‚

**Intuition 4** (Votes from the past counter pre-mining attacks). 
Consider an attacker that creates a block y , withholds it, and constructs many blocks on top of it over an extended period of time. 
After a long while, a conï¬‚icting transaction is released to the network, and eventually ends up in some block x. 
Block y has many blocks (built by the attacker) that reference it. 
Thus, if only votes from the future are counted, block y would prevail even if x is allowed to accumulate some votes. 
In SPECTRE, blocks that were created by honest nodes while y was withheld, look to their future for their votes. 
These will usually vote in favour of x and will usually outnumber the attacker blocks that were created when y was withheld (an example of pre-mining appears in Fig. 3). 

**æ€è·¯4**ï¼ˆè¿‡å»é›†çš„æŠ•ç¥¨å¯ä»¥åå‡»é¢„æŒ–çŸ¿æ”»å‡»ï¼‰ã€‚
å‡å®šä¸€ä¸ªæ”»å‡»è€…åˆ›å»ºäº†ä¸€ä¸ªå—yï¼Œå¹¶æ‰£ç•™å®ƒï¼Œå¹¶åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…åœ¨å®ƒä¸Šé¢æ„å»ºå¾ˆå¤šå—ã€‚
å¾ˆé•¿ä¸€æ®µæ—¶é—´åï¼Œä¸€ä¸ªå†²çªçš„äº¤æ˜“è¢«é‡Šæ”¾åˆ°ç½‘ç»œï¼Œå¹¶æœ€ç»ˆè¢«å†™å…¥åˆ°æŸä¸ªå—xä¸­ã€‚
å—yæœ‰å¾ˆå¤šå—ï¼ˆç”±æ”»å‡»è€…æ„å»ºï¼‰å¼•ç”¨å®ƒã€‚
å› æ­¤ï¼Œå¦‚æœåªè®¡ç®—æœªæ¥çš„ç¥¨æ•°ï¼Œå³ä½¿å…è®¸xç´¯ç§¯ä¸€äº›ç¥¨æ•°ï¼ŒåŒºå—yä¹Ÿä¼šå ä¸Šé£ã€‚
åœ¨SPECTREä¸­ï¼Œåœ¨yè¢«éšç’æ—¶ç”±è¯šå®èŠ‚ç‚¹åˆ›å»ºçš„å—ï¼Œä¼šå‘ä»–ä»¬çš„æœªæ¥é›†å¯»æ±‚å®ƒä»¬çš„æŠ•ç¥¨ã€‚
è¿™äº›é€šå¸¸ä¼šæŠ•ç¥¨æ”¯æŒxï¼Œå¹¶ä¸”é€šå¸¸ä¼šè¶…è¿‡yè¢«éšç’æ—¶åˆ›å»ºçš„æ”»å‡»è€…åŒºå—ï¼ˆé¢„æŒ–æ˜çš„ä¸€ä¸ªä¾‹å­å‡ºç°åœ¨å›¾3ä¸­ï¼‰ã€‚


Fig. 2: SPECTRE coincides with the longest-chain rule when it is applied to â€œsimpleâ€ chains of blocks. 
In the depicted DAG, the chain ending at block 8 is longer and would be selected in the longest chain protocol. 
In SPECTRE each one of the blocks 5,6,7,8 precedes each of the blocks in 9,10,11. 
Consider for instance blocks 6 and 10 and the pairwise vote that involves them. 
Blocks 6-8 vote strongly 6 â‰º 10, as they see block 6 in their past but not block 10. 
Block 5 is a weak voter, as it sees neither 6 nor 10 in its past, hence it votes as the majority of its future (thus voting 6 â‰º 10 as well). 
For similar reasons, blocks 9-11 all vote 10 â‰º 6. 
Block 4, at the fork of the two chains, is a weak voters as well, as it sees neither 6 nor 10 in its past; it therefore votes according to the majority of future blocks. 
As block 4 sees four votes in favour of 6 â‰º 10, and three votes in favour of 10 â‰º 6, it will vote in favour of 6 â‰º 10. 
Blocks 1-3 similarly vote according to their future, and see an increasing number of votes for 6 â‰º 10, adding their own vote to the result. 
Thus, the end result is that 6 precedes 10.

å›¾2ï¼šå½“SPECTREåº”ç”¨äºâ€œç®€å•â€åŒºå—é“¾æ—¶ï¼ŒSPECTREä¸æœ€é•¿é“¾è§„åˆ™ç›¸å»åˆã€‚(è¯‘æ³¨: ç®€å•è¿™é‡ŒæŒ‡, åˆ†æ”¯å¾ˆå°‘)
åœ¨æ‰€æç»˜çš„DAGä¸­ï¼Œä»¥åŒºå—8ä¸ºç»“å°¾çš„é“¾æ›´é•¿, å› æ­¤ä¼šè¢«é€‰å–ä¸ºæœ€é•¿é“¾ã€‚
åœ¨SPECTREä¸­ï¼ŒåŒºå—5,6,7,8ä¸­çš„æ¯ä¸€ä¸ªéƒ½åœ¨9,10,11ä¸­çš„æ¯ä¸ªå—ä¹‹å‰ã€‚
è€ƒè™‘ä¾‹å¦‚åŒºå—6å’Œ10ä»¥åŠæ¶‰åŠå®ƒä»¬çš„æˆå¯¹æŠ•ç¥¨ã€‚ã€‚
åŒºå—6-8ä¼šæ˜ç¡®åœ°æŠ•ç¥¨ç»™6 â‰º 8ï¼Œå› ä¸ºä»–ä»¬çœ‹åˆ°è¿‡å»é›†çš„å—6ï¼Œè€Œä¸æ˜¯å—10ã€‚
å—5æ— æ³•æ˜ç¡®åœ°æŠ•ç¥¨ï¼Œå› ä¸ºå®ƒè¿‡å»é›†æ²¡æœ‰çœ‹åˆ°è¿‡6ï¼Œä¹Ÿæ²¡æœ‰çœ‹åˆ°è¿‡10ï¼Œæ‰€ä»¥å®ƒä¼šæ ¹æ®å…¶æœªæ¥é›†ä¸­å¤šæ•°ç¥¨æ¥æŠ•ç¥¨ï¼ˆå› æ­¤ä¹ŸæŠ•ç¥¨ç»™6 â‰º 10ï¼‰ ï¼‰ã€‚
ç”±äºç±»ä¼¼çš„åŸå› ï¼Œ9-11å—éƒ½æŠ•äº†10 â‰º 6.
åŒºå—4åœ¨ä¸¤ä¸ªé“¾çš„åˆ†å‰å¤„ï¼Œä¹Ÿæ— æ³•æ˜ç¡®æŠ•ç¥¨, yå› ä¸ºå®ƒæ— æ³•åœ¨å…¶è¿‡å»é›†ä¸­çœ‹åˆ°6å’Œ10;å®ƒå› æ­¤ä¼šæ ¹æ®å…¶å°†æ¥é›†ä¸­çš„åŒºå—å¤šæ•°ç¥¨æ¥æŠ•ç¥¨ã€‚
å› ä¸ºåŒºå—4çœ‹åˆ°å››ç¥¨æŠ•ç»™äº†6 â‰º 10, è¿˜æœ‰ä¸‰ç¥¨æŠ•ç»™äº†10  â‰º 6, å®ƒä¼šæŠ•ç¥¨ç»™6 â‰º 10.
ç±»ä¼¼åœ°, åŒºå—1-3æ ¹æ®å®ƒä»¬çš„å°†æ¥é›†æŠ•ç¥¨ï¼Œå¯ä»¥çœ‹åˆ°æŠ•ç»™6 â‰º 10çš„ç¥¨æ•°è¶Šæ¥è¶Šå¤šï¼Œä¼šå°†å®ƒä»¬è‡ªå·±çš„ç¥¨æŠ•ç»™è¿™ä¸ªç»“æœã€‚
å› æ­¤ï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯6æ¯”10é å‰ã€‚

## A. Equivalence to longest-chain
## A. ç­‰æ•ˆäºæœ€é•¿é“¾è§„åˆ™

We now demonstrate how SPECTRE coincides with Bitcoinâ€™s longest-chain rule, in the case of a â€œsimpleâ€ fork between two chains. 
Consider the DAG illustrated in Fig. 2. 
In Bitcoin, the longer chain would be selected. 
Similarly, in the pairwise ordering of SPECTRE, each of the blocks in the longest chain 5,6,7,8 would precede each of the blocks in the shorter one 9,10,11. 
To see why this is true refer to the caption of the ï¬gure.

ç°åœ¨æˆ‘ä»¬æ¥æ¼”ç¤ºä¸€ä¸‹SPECTREä¸ºä»€ä¹ˆå’Œæ¯”ç‰¹å¸æ˜¯ä¸€è‡´ï¼Œé‚£ä¹ˆä¸¤ä¸ªé“¾ä¹‹é—´çš„â€œç®€å•â€åˆ†å‰å°±æ˜¯ä¸€ä¾‹ã€‚ 
è€ƒè™‘å›¾2æ‰€ç¤ºçš„DAGã€‚
åœ¨æ¯”ç‰¹å¸ä¸­ï¼Œé€‰æ‹©è¾ƒé•¿çš„é“¾ã€‚ 
ç±»ä¼¼åœ°ï¼Œåœ¨SPECTERçš„æˆå¯¹æ’åºä¸­ï¼Œæœ€é•¿é“¾5,6,7,8ä¸­çš„æ¯ä¸ªå—å°†ä½äºè¾ƒçŸ­å—9,10,11ä¸­çš„æ¯ä¸ªå—ä¹‹å‰ã€‚ 
è¦æ˜ç™½ä¸ºä»€ä¹ˆè¿™æ˜¯çœŸçš„ï¼Œè¯·å‚è€ƒæ•°æ®çš„æ ‡é¢˜ã€‚

We now turn to examine two different attack scenarios, which we name double-spending, and censorship. 
Recall the requirement from our miner protocol: each miner is required to (i) reference recent blocks, and to (ii) publish his blocks immediately. 
Each attack is basically a violation of one of these requirements. 
In the double-spending attack, the attacker delays the publication of a set of blocks (that includes a conï¬‚icting transaction), and in the censorship attack he publishes blocks but â€œignoresâ€ a certain block and transactions inside it, hoping to convince nodes that it did not secure enough votes, and thus cannot be accepted.

æˆ‘ä»¬ç°åœ¨è½¬è€Œè€ƒå¯Ÿä¸¤ç§ä¸åŒçš„æ”»å‡»æƒ…æ™¯ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºåŒèŠ±å’Œå®¡æŸ¥ã€‚ 
å›æƒ³ä¸€ä¸‹æˆ‘ä»¬çŸ¿å·¥åè®®çš„è¦æ±‚ï¼šæ¯ä¸ªçŸ¿å·¥å¿…é¡»ï¼ˆiï¼‰å¼•ç”¨æœ€è¿‘çš„å—ï¼Œå¹¶ï¼ˆiiï¼‰ç«‹å³å‘å¸ƒä»–çš„å—ã€‚ 
æ¯ç§æ”»å‡»åŸºæœ¬ä¸Šéƒ½è¿åäº†è¿™äº›è¦æ±‚ä¹‹ä¸€ã€‚ 
åœ¨åŒèŠ±æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…æ¨è¿Ÿå‘å¸ƒä¸€ç»„å—ï¼ˆåŒ…æ‹¬å†²çªäº¤æ˜“ï¼‰ï¼Œå¹¶ä¸”åœ¨å®¡æŸ¥æ”»å‡»ä¸­ï¼Œä»–å‘å¸ƒäº†å—ï¼Œä½†æ˜¯â€œå¿½ç•¥â€æŸä¸ªå—å’Œå…¶ä¸­äº¤æ˜“ï¼Œå¸Œæœ›è¯´æœèŠ‚ç‚¹è¯¥å—æ²¡æœ‰è·å¾—è¶³å¤Ÿçš„é€‰ç¥¨ï¼Œå› æ­¤è¯¥å—ä¸èƒ½è¢«æ¥å—ã€‚

## B. Example of a double-spending attack
## B. åŒèŠ±æ”»å‡»çš„ä¾‹å­

Fig. 3 depicts an (unsuccessful) double-spending attack. The attack is composed of three main phases:
å›¾3æè¿°äº†ä¸€æ¬¡ï¼ˆä¸æˆåŠŸï¼‰çš„åŒèŠ±æ”»å‡»ã€‚ æ”»å‡»ç”±ä¸‰ä¸ªä¸»è¦é˜¶æ®µç»„æˆï¼š

**Phase I: Pre-mining.** 
In phase I, the attacker begins building blocks and withholding them from the network. 
The ï¬rst block that is constructed (named block y ) contains a transaction that will later conï¬‚ict with the transaction sent to the honest nodes. 
Blocks built by the attacker ideally form a chain, and due to the voting rules in SPECTRE, will all vote y â‰º x (blocks y ,13,14). 
Blocks built by the honest node are unaware of y (and also of x that is yet to be created), and will eventually vote according to the majority of future votes. 
During this phase, attacker blocks reference honest blocks that are built (in hopes of later convincing them to vote y â‰º x). 
After some time, the attacker transmits the transaction to the network, and proceeds to phase II.

**é˜¶æ®µIï¼šé¢„æŒ–** 
åœ¨é˜¶æ®µIä¸­ï¼Œæ”»å‡»è€…å¼€å§‹æ„å»ºåŒºå—å¹¶ç»„ç»‡å®ƒä»¬è¿›å…¥ç½‘ç»œ, ã€‚ 
æ„é€ çš„ç¬¬ä¸€ä¸ªå—ï¼ˆåä¸ºå—yï¼‰åŒ…å«ä¸€ä¸ªäº¤æ˜“ï¼Œç¨åå°†ä¸å‘é€ç»™è¯šå®èŠ‚ç‚¹çš„äº¤æ˜“å†²çªã€‚ 
ç”±æ”»å‡»è€…æ„å»ºçš„åŒºå—åœ¨ç†æƒ³çš„åŒºå—ä¸‹ä¼šå½¢æˆä¸€ä¸ªé“¾ï¼Œå¹¶ä¸”ç”±äºSPECTREä¸­çš„æŠ•ç¥¨è§„åˆ™ï¼Œå®ƒä»¬éƒ½ä¼šæŠ•ç¥¨ y â‰º xï¼ˆå—yï¼Œ13,14ï¼‰ã€‚ 
ç”±è¯šå®èŠ‚ç‚¹æ„å»ºçš„å—ä¸çŸ¥é“yï¼ˆè¿˜æœ‰å°šæœªåˆ›å»ºçš„xï¼‰ï¼Œå¹¶ä¸”æœ€ç»ˆå°†æ ¹æ®å¤§å¤šæ•°æœªæ¥æŠ•ç¥¨è¿›è¡ŒæŠ•ç¥¨ã€‚ 
åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ”»å‡»è€…ä¼šé˜»æ­¢è¢«åˆ›å»ºè¯šå®å—ï¼ˆå¸Œæœ›ä»¥åè¯´æœä»–ä»¬æŠ•ç¥¨y â‰º xï¼‰ã€‚ 
ä¸€æ®µæ—¶é—´åï¼Œæ”»å‡»è€…å°†äº¤æ˜“ä¼ è¾“åˆ°ç½‘ç»œï¼Œç„¶åè¿›å…¥ç¬¬äºŒé˜¶æ®µã€‚

Transaction X is broadcast

Attacker broadcasts blocks

2 (X<Y)

X (X<Y)

6 (X<Y)

8 (X<Y)

10 (X<Y)

4 (X<Y)

12 (X<Y)

1 (X<Y)

3 (X<Y)

5 (X<Y)

15 (Y<X)

7 (X<Y)

9 (X<Y)

11 (X<Y)

Y (Y<X)

13 (Y<X)

14 (Y<X)

16 (Y<X)

17 (Y<X)

18 (Y<X)

19 (Y<X)

Phase I: pre-mining

Phase II: attack remains hidden until merchant accepts

Phase III: race to overtake

time

Fig. 3: An example of the voting procedure on a DAG in which a double-spending attack is (unsuccessfully) attempted. 
Block x and blocks 6-8 vote strongly x â‰º y as they only see x in their past, and not y . 
Similarly, block y and blocks 13-19 vote strongly y â‰º x. 
In the DAG which is the past of block 11, each of the blocks 1-5 sees more x â‰º y voters in its future than y â‰º x voters, hence each of them votes x â‰º y . 
Block 11 votes (as the virtual block of its past votes), according to the majority in its past, thus it too votes x â‰º y . 
A similar argument goes for the the vote of 11 and 12. 
Finally, aggregating the vote of all blocks in the DAG, x got more votes hence x â‰º y .

å›¾3ï¼šDAGä¸­æŠ•ç¥¨ç¨‹åºçš„ä¸€ä¸ªä¾‹å­ï¼Œå…¶ä¸­å°è¯•äº†åŒèŠ±æ”»å‡»ï¼ˆæœªæˆåŠŸï¼‰ã€‚ 
å—xå’Œå—6-8æ˜ç¡®æŠ•ç¥¨æ”¯æŒx â‰º yï¼Œå› ä¸ºä»–ä»¬åªåœ¨å®ƒä»¬çš„è¿‡å»é›†åˆçœ‹åˆ°xï¼Œè€Œä¸æ˜¯yã€‚ 
åŒæ ·ï¼ŒåŒºå—yå’ŒåŒºå—13-19æ˜ç¡®æŠ•ç¥¨æ”¯æŒy â‰º Xã€‚ 
åœ¨å—11çš„è¿‡å»é›†å½¢æˆçš„DAGä¸­ï¼Œå—1-5ä¸­çš„æ¯ä¸ªå—åœ¨å„è‡ªçš„å°†æ¥é›†ä¸­å¯ä»¥çœ‹åˆ°æ”¯æŒx â‰º y çš„æ¯” y â‰º x æ›´å¤šï¼Œå› æ­¤å®ƒä»¬éƒ½æŠ•ç¥¨æ”¯æŒx â‰º yã€‚ 
åŒºå—11(å¯ä»¥çœ‹ä½œæ˜¯å®ƒè¿‡å»é›†çš„è™šæ‹Ÿå—)æ ¹æ®å®ƒè¿‡å»é›†çš„å¤§å¤šæ•°æ¥æŠ•ç¥¨, å› æ­¤ä¹Ÿä¼šæŠ•ç¥¨æ”¯æŒx â‰º y .
ç±»ä¼¼çš„æ€è·¯ä¹Ÿå¯ä»¥ç”¨äºæ±‚å¾—åŒºå—11å’Œ12çš„æŠ•ç¥¨ã€‚
æœ€åï¼Œæ±‡æ€»DAGä¸­æ‰€æœ‰å—çš„æŠ•ç¥¨ï¼Œxå¾—åˆ°æ›´å¤šçš„é€‰ç¥¨ï¼Œå› æ­¤xï¼Ÿ yã€‚



Notice that at the exact time that phase I ends, the attacker has more blocks above block 4 than honest nodes have, so it starts at an advantage: it will more easily sway the vote of block 4 towards y â‰º x (this advantage later disappears as honest nodes typically build blocks faster than the attacker).

è¯·æ³¨æ„ï¼Œåœ¨é˜¶æ®µIç»“æŸçš„ç¡®åˆ‡æ—¶é—´ï¼Œæ”»å‡»è€…æ¯”çœŸå®èŠ‚ç‚¹å…·æœ‰æ›´å¤šçš„å—åœ¨å—4ä¸Šæ–¹ï¼Œå› æ­¤å®ƒä»ä¸€ä¸ªä¼˜ç‚¹å¼€å§‹ï¼šå®ƒå°†æ›´å®¹æ˜“åœ°å°†å—4çš„æŠ•ç¥¨ç§»å‘yï¼Ÿ xï¼ˆè¿™ç§ä¼˜åŠ¿éšåæ¶ˆå¤±ï¼Œå› ä¸ºè¯šå®çš„èŠ‚ç‚¹é€šå¸¸æ¯”æ”»å‡»è€…æ›´å¿«åœ°æ„å»ºå—ï¼‰ã€‚

**Phase II: Waiting for acceptance.** 
The attacker now continues to build blocks in secret. 
If he publishes his blocks, then his conï¬‚icting transaction will be visible to all, and the double-spend will be detected. 
Instead, he waits for block x to receive sufï¬cient weight (in the form of blocks built on top of it) so that the recipient of the transaction in x accepts it, and provides the attacker with some service or product. 
During this phase, attacker blocks that are created (blocks 15-17) vote y â‰º x, as the attacker is careful to have them reference only his secret chain, and never indirectly reference block x. 
Honest blocks created during this phase will typically vote x â‰º y since y is hidden from them. 
Some small number of blocks (created before x propagated to the whole network â€“ block 5 in this example) do not reference x, and so will vote according to the result of future votes.

**ç¬¬äºŒé˜¶æ®µï¼šç­‰å¾…æ¥å—ã€‚** 
æ”»å‡»è€…ç°åœ¨ç»§ç»­ç§˜å¯†æ„å»ºåŒºå—ã€‚ 
å¦‚æœä»–å‘å¸ƒäº†ä»–çš„åŒºå—ï¼Œé‚£ä¹ˆæ‰€æœ‰äººéƒ½å¯ä»¥çœ‹åˆ°ä»–çš„å†²çªäº¤æ˜“ï¼Œå¹¶ä¸”ä¼šæ£€æµ‹åˆ°åŒèŠ±ã€‚ 
ç›¸åï¼Œä»–ç­‰å¾…å—xæ¥æ”¶è¶³å¤Ÿçš„æƒé‡ï¼ˆä»¥åœ¨å…¶ä¸Šæ„å»ºçš„åŒºå—çš„å½¢å¼ï¼‰ï¼Œä»¥ä¾¿xä¸­çš„äº¤æ˜“çš„æ¥æ”¶è€…æ¥å—å®ƒï¼Œå¹¶å‘æ”»å‡»è€…æä¾›æŸç§æœåŠ¡æˆ–äº§å“ã€‚ 
åœ¨æ­¤é˜¶æ®µï¼Œè¢«åˆ›å»ºçš„æ”»å‡»å—(åŒºå—15-17)æŠ•ç¥¨ç»™ y â‰º xï¼Œå› ä¸ºæ”»å‡»è€…å°å¿ƒåœ°è®©å®ƒä»¬ä»…å¼•ç”¨ä»–çš„ç§˜å¯†é“¾ï¼Œå¹¶ä¸”ä»ä¸é—´æ¥å¼•ç”¨å—xã€‚ 
åœ¨æ­¤é˜¶æ®µåˆ›å»ºçš„è¯šå®å—é€šå¸¸ä¼šæŠ•ç¥¨x â‰º y å› ä¸ºyæ˜¯éšè—çš„ã€‚ 
å°‘é‡çš„å—ï¼ˆåœ¨xä¼ æ’­åˆ°æ•´ä¸ªç½‘ç»œä¹‹å‰åˆ›å»º - åœ¨æœ¬ä¾‹ä¸­ä¸ºå—5ï¼‰æ²¡æœ‰å¼•ç”¨xï¼Œå› æ­¤å°†æ ¹æ®æœªæ¥æŠ•ç¥¨çš„ç»“æœè¿›è¡ŒæŠ•ç¥¨ã€‚

**Phase III: Race to overtake.** 
Once x was -accepted by the victim, the attacker wishes to publish his secret blocks in hopes of causing his conï¬‚icting transaction in y to precede x. 
In this case, the transaction in x will be considered rejected, and the payment will be canceled (leaving the attacker with an item he did not pay for). 
He publishes his secret chain (which from this point on is referenced by honest nodes), and continues to build upon it. 
Blocks that he builds, again do not reference x, and so they vote y â‰º x, supporting his goal. 
New honest nodes are for the ï¬rst time exposed to the conï¬‚icting transaction y , and thus vote according to the result in the sub-DAG in their past.

**ç¬¬ä¸‰é˜¶æ®µï¼šç«äº‰ä»¥èµ¶è¶…ã€‚** 
ä¸€æ—¦xè¢«å—å®³è€…æ¥å—ï¼Œæ”»å‡»è€…å°±å¸Œæœ›å‘å¸ƒä»–çš„ç§˜å¯†å—ï¼Œå¸Œæœ›ä½¿ä»–çš„å†²çªäº¤æ˜“yåœ¨xä¹‹å‰ã€‚ 
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œxä¸­çš„äº¤æ˜“å°†è¢«è§†ä¸ºå·²é©³å›ï¼Œå¹¶ä¸”ä»˜æ¬¾å°†è¢«å–æ¶ˆï¼ˆå‘æ”»å‡»è€…ç•™ä¸‹ä»–æœªæ”¯ä»˜çš„äº¤æ˜“ï¼‰ã€‚ 
ä»–å‘å¸ƒäº†ä»–çš„ç§˜å¯†é“¾ï¼ˆä»è¿™ä¸ªæ—¶é—´ç‚¹å¼€å§‹ï¼Œç”±è¯šå®çš„èŠ‚ç‚¹å¼•ç”¨ï¼‰ï¼Œå¹¶ç»§ç»­åœ¨å®ƒä¸Šé¢æ„å»ºã€‚ 
ä»–å»ºç«‹çš„å—ï¼Œå†å¼ºè°ƒä¸‹ä¸å¼•ç”¨xçš„ï¼Œæ‰€ä»¥ä»–ä»¬ä¼šæŠ•ç¥¨y â‰º xï¼Œæ”¯æŒä»–çš„ç›®æ ‡ã€‚ 
æ–°çš„è¯šå®èŠ‚ç‚¹é¦–æ¬¡æš´éœ²äºå†²çªäº¤æ˜“yï¼Œå› æ­¤æ ¹æ®è¿‡å»é›†çš„å­DAGä¸­çš„ç»“æœè¿›è¡ŒæŠ•ç¥¨ã€‚

Why the attack fails. 
First, notice that the attacker in the above example creates fewer blocks in each phase than the honest nodes. 
This will usually be the case if attackers have less computational power than all honest nodes. 
â€œPoisson burstsâ€ in block creation by the attacker are possible, and this will allow him to overtake the network, but these are less likely if the attack lasts for a long period of time. 
The defender can control the length of phase II by waiting a long while before accepting the transaction, which decreases the probability of such bursts. 
If phase II is long enough, x will have more votes in this period than y . 
Weak blocks in the past of x will then vote in favour of x, according to this majority. 
Such blocks that look at their future begin a cascade: each block further in the past adds a vote that agrees with the majority of future blocks and thus strengthens the decision. 
The greater the majority obtained in Phase II, the less likely it is that the attacker will be able to catch up from behind in Phase III. 
The attack therefore depends heavily on successfully swaying the votes of blocks that were created just before x (e.g., block 4).

ä¸ºä»€ä¹ˆæ”»å‡»ä¼šå¤±è´¥ã€‚
é¦–å…ˆï¼Œè¯·æ³¨æ„ä¸Šé¢ç¤ºä¾‹ä¸­çš„æ”»å‡»è€…åœ¨æ¯ä¸ªé˜¶æ®µä¸­åˆ›å»ºçš„å—æ¯”è¯šå®èŠ‚ç‚¹å°‘ã€‚
å¦‚æœæ”»å‡»è€…çš„è®¡ç®—èƒ½åŠ›ä½äºæ‰€æœ‰è¯šå®èŠ‚ç‚¹ï¼Œåˆ™é€šå¸¸ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚
æ”»å‡»è€…åˆ›å»ºå—æ—¶å¯èƒ½ä¼šå‡ºç°â€œæ³Šæ¾çˆ†å‘(Poisson bursts)â€ï¼Œè¿™å°†ä½¿ä»–èƒ½å¤Ÿè¶…è¶Šç½‘ç»œï¼Œä½†å¦‚æœæ”»å‡»æŒç»­å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œåˆ™ä¸å¤ªå¯èƒ½ã€‚(è¯‘æ³¨: æŸæ¾çˆ†å‘è¿™é‡ŒæŒ‡æœ‰å¯èƒ½æ”»å‡»è€…çŸ­æœŸå†…å‡ºå—é€Ÿåº¦æ¯”å…¨ç½‘å…¶ä»–èŠ‚ç‚¹å¿«, ä½†è¿™ç§æ˜¯å°æ¦‚ç‡æ—¶é—´, ä¸”å¾ˆéš¾æŒç»­)
é€šè¿‡åœ¨æ¥å—äº¤æ˜“ä¹‹å‰ç­‰å¾…å¾ˆé•¿æ—¶é—´ï¼Œé˜²å¾¡è€…å¯ä»¥æ§åˆ¶ç¬¬äºŒé˜¶æ®µçš„é•¿åº¦ï¼Œè¿™é™ä½äº†è¿™ç§çªå‘çš„å¯èƒ½æ€§ã€‚
å¦‚æœç¬¬äºŒé˜¶æ®µè¶³å¤Ÿé•¿ï¼Œxå°†åœ¨æ­¤æœŸé—´è·å¾—æ¯”yæ›´å¤šçš„é€‰ç¥¨ã€‚
æ ¹æ®å¤šæ•°äººçš„è¯´æ³•ï¼Œxè¿‡å»çš„å¼±å—å°†æŠ•ç¥¨æ”¯æŒxã€‚
è¿™äº›çœ‹å¾…æœªæ¥çš„åŒºå—å¼€å§‹äº†ä¸€ä¸ªçº§è”ï¼šè¿‡å»çš„æ¯ä¸ªåŒºå—éƒ½ä¼šå¢åŠ ä¸€ä¸ªä¸å¤§å¤šæ•°æœªæ¥åŒºå—ä¸€è‡´çš„æŠ•ç¥¨ï¼Œä»è€ŒåŠ å¼ºå†³ç­–ã€‚ç¬¬äºŒé˜¶æ®µè·å¾—çš„å¤§å¤šæ•°äººè¶Šå¤šï¼Œæ”»å‡»è€…åœ¨ç¬¬ä¸‰é˜¶æ®µå°±èƒ½è¶Šè¿‡åå«çš„å¯èƒ½æ€§è¶Šå°ã€‚
å› æ­¤ï¼Œæ”»å‡»åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæˆåŠŸåœ°æ‘‡æ‘†åœ¨xä¹‹å‰åˆ›å»ºçš„å—çš„æŠ•ç¥¨ï¼ˆä¾‹å¦‚ï¼Œå—4ï¼‰ã€‚

It is important to note that an attacker that creates more blocks in expectation than the honest network will succeed in carrying out this attack. 
The blocks voting y â‰º x would outnumber those who vote to the contrary. 
Hence the 50% threshold in Theorem 3.

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ”»å‡»è€…å¦‚æœé¢„æœŸèƒ½æ¯”è¯šå®ç½‘ç»œåˆ›å»ºæ›´å¤šçš„åŒºå—, åˆ™å¯ä»¥æˆåŠŸå®æ–½è¿™ç§æ”»å‡»ã€‚ 
æŠ•ç¥¨æ”¯æŒy â‰º xçš„åŒºå—ä¼šè¶…è¿‡é‚£äº›æŠ•åå¯¹ç¥¨çš„ã€‚ 
å› æ­¤ï¼Œå®šç†3ä¸­çš„é˜ˆå€¼ä¸º50ï¼…ã€‚

## C. Example of a censorship attack
## C. å®¡æŸ¥æ”»å‡»çš„ä¾‹å­

Fig. 4 depicts an (unsuccessful) censorship attack. 
The attack is composed of a single main phase during which an attacker creates his own blocks, publishes them instantly, but also ignores (and does not reference) recent blocks created by the honest network. 
The ï¬gure depicts (in stage I on the left side) the current state of the blockchain (where all blocks are published at this point). 
An honest participant that then observes the network and wishes to tell if a transaction in block x is secure, can see a large number of blocks that do not reference x. 
These blocks are not guaranteed to vote in favour of x. 
An attacker may later insert a conï¬‚icting transaction y and add blocks atop it (this projected attack is depicted on the right-hand side of the ï¬gure). 
These may potentially sway previously created attacker blocks to vote against x.

å›¾4æç»˜äº†ä¸€æ¬¡ï¼ˆä¸æˆåŠŸçš„ï¼‰å®¡æŸ¥æ”»å‡»ã€‚
 æ”»å‡»ç”±ä¸€ä¸ªä¸»è¦é˜¶æ®µç»„æˆï¼Œæ”»å‡»è€…åœ¨æ­¤æœŸé—´åˆ›å»ºè‡ªå·±çš„å—ï¼Œå¹¶ç«‹å³å‘å¸ƒï¼Œä½†ä¹Ÿå¿½ç•¥ï¼ˆå¹¶ä¸”ä¸å‚è€ƒï¼‰è¯šå®ç½‘ç»œæ–°å»ºçš„å—ã€‚ 
 è¯¥å›¾æç»˜äº†ï¼ˆåœ¨å·¦ä¾§çš„ç¬¬ä¸€é˜¶æ®µï¼‰åŒºå—é“¾çš„å½“å‰çŠ¶æ€ï¼ˆæ­¤æ—¶æ‰€æœ‰åŒºå—éƒ½è¢«å…¬å¸ƒï¼‰ã€‚
  ç„¶åï¼Œä¸€ä¸ªè¯šå®çš„å‚ä¸è€…è§‚å¯Ÿç½‘ç»œå¹¶å¸Œæœ›åˆ¤æ–­å—xä¸­çš„äº¤æ˜“æ˜¯å¦å®‰å…¨ï¼Œå¯ä»¥çœ‹åˆ°å¤§é‡ä¸å¼•ç”¨xçš„å—ã€‚ 
  è¿™äº›åŒºå—ä¸ä¿è¯æŠ•ç¥¨æ”¯æŒxã€‚ 
  æ”»å‡»è€…å¯èƒ½ç¨åæ’å…¥å†²çªäº¤æ˜“yå¹¶åœ¨å…¶ä¸Šæ·»åŠ å—ï¼ˆæ­¤é¢„æµ‹æ”»å‡»æç»˜åœ¨å›¾çš„å³ä¾§ï¼‰ã€‚ 
  è¿™äº›å¯èƒ½ä¼šå½±å“å…ˆå‰åˆ›å»ºçš„æ”»å‡»è€…å—ä»¥æŠ•ç¥¨åå¯¹xã€‚

The main risk from the censorship attack is that merchants, upon seeing the attackerâ€™s blocks, will consider transactions in block x not sufï¬ciently secure. 
This could potentially delay the acceptance of transactions forever. 
Our analysis of SPECTRE shows that even in this case the merchants accept transactions quickly (and securely).

å®¡æŸ¥æ”»å‡»çš„ä¸»è¦é£é™©æ˜¯ï¼Œå•†å®¶åœ¨çœ‹åˆ°æ”»å‡»è€…çš„åŒºå—åï¼Œä¼šè®¤ä¸ºåŒºå—xä¸­çš„äº¤æ˜“ä¸å¤Ÿå®‰å…¨ã€‚ 
è¿™å¯èƒ½ä¼šæ°¸ä¹…å»¶è¿Ÿå¯¹äº¤æ˜“çš„æ¥å—ã€‚ 
æˆ‘ä»¬å¯¹SPECTREçš„åˆ†æè¡¨æ˜ï¼Œå³ä½¿åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå•†å®¶ä¹Ÿèƒ½å¿«é€Ÿï¼ˆå’Œå®‰å…¨åœ°ï¼‰æ¥å—äº¤æ˜“ã€‚

Present

X (X<Y)

3 (X<Y)

5 (X<Y)

7 (X<Y)

9 (X<Y)

2 (X<Y)

11 (X<Y)

1 (X<Y)

4 (X<Y)

6 (X<Y)

8 (X<Y)

10 (X<Y)

12 (X<Y)

13 (X<Y)

14 (X<Y)

15 (X<Y)

16 (Y<X)

Y (Y<X)

17 (Y<X)

18 (Y<X)

Phase I: X gains confirmations, but attacker blocks ignore X.

Projected Future attack. (double spend Y appears)

time

Fig. 4: An example of the voting procedure on DAG in which an unsuccessful censorship attack is depicted. 
The left side depicts the current state of the block DAG. 
The right-hand side depicts its likely future development. 
Blocks 12-16 do not add strong votes to x. 
Can they be convinced to vote for block y when it appears? 
Will they further sway other blocks in their past? 
The vote of each block in this projected future are depicted: Blocks 2-9 vote strongly for x as they see it in their past (but not y ). 
Blocks 17-18 similarly vote strongly for y . 
Block 16 is indeed convinced to vote for y as more blocks in its future vote for y than for x. 
Blocks 1, 12-15 vote for x. 
They each see more votes in favour of x than votes in favour of y in their future. 
Blocks 10-11 see more x â‰º y voters in their past when they make a recursive call.

å›¾4ï¼šDAGçš„æŠ•ç¥¨ç¨‹åºç¤ºä¾‹ï¼Œå…¶ä¸­æè¿°äº†ä¸€æ¬¡ä¸æˆåŠŸçš„å®¡æŸ¥æ”»å‡»ã€‚ 
å·¦ä¾§æç»˜äº†åŒºå—DAGçš„å½“å‰çŠ¶æ€ã€‚ 
å³ä¾§æç»˜äº†å…¶æœªæ¥å¯èƒ½çš„å‘å±•ã€‚ 
åŒºå—12-16æ— æ³•æ˜ç¡®æŠ•ç¥¨ç»™xã€‚ 
å½“å®ƒå‡ºç°æ—¶ï¼Œå®ƒä»¬èƒ½å¦è¢«è¯´æœæŠ•ç¥¨æ”¯æŒyï¼Ÿ 
å®ƒä»¬ä¼šè¿›ä¸€æ­¥å½±å“å®ƒä»¬è¿‡å»é›†çš„å…¶ä»–åŒºå—å—ï¼Ÿ 
åœ¨è¿™ä¸ªé¢„è®¡çš„æœªæ¥ä¸­ï¼Œæ¯ä¸ªåŒºå—çš„æŠ•ç¥¨éƒ½å¯ä»¥è¢«æç»˜å‡ºæ¥ï¼šåŒºå—2-9ä¼šæ˜ç¡®æŠ•ç¥¨æ”¯æŒxå› ä¸ºå®ƒä»¬åœ¨å®ƒä»¬çš„è¿‡å»é›†ä¸­çœ‹åˆ°äº†x(è€Œä¸æ˜¯y)ã€‚ 
åŒºå—17-18åŒæ ·æ˜ç¡®æŠ•ç¥¨ç»™yã€‚ 
äº‹å®ä¸Šï¼Œå—16ç¡®è®¤æŠ•ç¥¨ç»™yå› ä¸ºå®ƒåœ¨å®ƒçš„å°†æ¥é›†ä¸­çœ‹åˆ°æ›´å¤šçš„åŒºå—æ”¯æŒè€Œéxã€‚ 
å—1,12-15æŠ•ç¥¨ç»™xã€‚ 
å®ƒä»¬æ¯ä¸ªäºº åœ¨å®ƒä»¬æœªæ¥é›†ä¸­éƒ½çœ‹åˆ°æ”¯æŒxçš„æŠ•ç¥¨å¤šäºæ”¯æŒyã€‚ 
å—10-11åœ¨å®ƒä»¬çš„è¿‡å»é›†ä¸­é€’å½’è°ƒç”¨æ—¶çœ‹åˆ°æ›´å¤šçš„åŒºå—æ”¯æŒx â‰º yã€‚
